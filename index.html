<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>ë±€íŒŒì´ì–´ ì €íƒ ë¯¸ë¡œ</title>

<style>
  body {
    margin: 0;
    background: #000;
    color: #f1d9de;
    font-family: "Apple SD Gothic Neo","Noto Sans KR","Pretendard",sans-serif;
    text-align: center;
  }

  button, a {
    background: #7a1f2b;
    color: #000;
    padding: 10px 18px;
    border-radius: 10px;
    border: none;
    font-size: 14px;
    font-weight: 600;
    text-decoration: none;
  }

  input {
    padding: 10px;
    border-radius: 8px;
    border: none;
    margin-top: 16px;
    font-size: 14px;
    text-align: center;
  }

  .screen {
    min-height: 100vh;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    padding: 24px;
  }

  .narration {
    max-width: 420px;
    font-size: 18px;
    line-height: 1.7;
    white-space: pre-line;
    margin-bottom: 20px;
  }

  .title {
    font-size: 22px;
    margin-bottom: 12px;
    color: #b01c3b;
  }

  .desc {
    max-width: 420px;
    font-size: 15px;
    line-height: 1.7;
    color: #d6b8be;
    margin-top: 8px;
  }

  .maze {
    display: grid;
    gap: 2px;
    justify-content: center;
    margin-top: 12px;
  }

  .cell {
    width: 28px;
    height: 28px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 18px;
  }

  .screen div[style*="margin-top:14px"] button {
  width: 34px;
  height: 34px;
  padding: 0;
  font-size: 15px;
  border-radius: 6px;      /* ëœ ë‘¥ê¸€ê²Œ */
  background: #111;
  color: #f1d9de;
  border: 1px solid #333;
  margin: 3px;
}

/* ëˆŒë €ì„ ë•Œ */
.screen div[style*="margin-top:14px"] button:active {
  background: #5a0f1b;
}

  .wall { background: #2a0006; }
  .path { background: #111; }
</style>
</head>

<body>
<div id="app"></div>

<script>
const GRID = 11;
const CELL = 28;
const START = {x:0,y:10};
const GOAL = {x:10,y:0};

const MAZE = [
 [1,1,1,1,1,1,1,1,1,1,0],
 [1,0,0,0,1,0,0,0,0,1,0],
 [1,0,1,0,1,0,1,1,0,1,0],
 [1,0,0,0,0,0,0,0,0,0,0],
 [1,0,1,1,1,1,0,1,1,1,1],
 [1,0,0,0,0,0,0,0,0,0,1],
 [1,1,1,1,1,1,1,1,1,0,1],
 [1,0,0,0,0,0,0,0,1,0,1],
 [1,0,1,1,1,1,1,0,1,0,1],
 [1,0,0,0,0,0,0,0,0,0,1],
 [0,0,1,1,1,1,1,1,1,1,1],
];

const TRAPS = [
  {x:5,y:9},{x:7,y:3},{x:6,y:4},{x:3,y:1}
];

const narration =
"íƒœì´ˆì˜ ë±€íŒŒì´ì–´ë¥¼ ë°©ë¬¸í•˜ê²Œ ëœ ë‹¹ì‹ ,\n" +
"í•˜ì§€ë§Œ ì €íƒì€ ìƒê°ë³´ë‹¤ ì™¸ì§„ ê³³ì— ìˆëŠ”ë°...\n" +
"ê³¼ì—° ì‹œê°„ ë‚´ì— ê¸¸ì„ ì°¾ì•„ê°ˆ ìˆ˜ ìˆì„ê¹Œ?";

let stage="intro", text="", i=0;
let nickname="";
let pos={...START}, startTime=0, elapsed=0;
let trapCount=0;
let revealed=[];

const app=document.getElementById("app");

function renderIntro(){
  app.innerHTML=`
    <div class="screen">
      <div class="narration">${text}</div>

      ${text.length===narration.length ? `
        <input id="nick" placeholder="ë‹‰ë„¤ì„ ì…ë ¥í•˜ê¸°"
          onkeydown="if(event.key==='Enter')confirmNick()" />
        ${nickname ? `<button onclick="startGame()">ì €íƒìœ¼ë¡œ ê°€ê¸°</button>` : ``}
      ` : ``}
    </div>
  `;
}

function confirmNick(){
  const v=document.getElementById("nick").value.trim();
  if(!v) return;
  nickname=v;
  renderIntro();
}

function renderMaze(){
  let html=`<div class="screen">
    <div class="maze" style="grid-template-columns:repeat(${GRID},${CELL}px)">`;

  for(let y=0;y<GRID;y++){
    for(let x=0;x<GRID;x++){
      let c="";
      if(pos.x===x&&pos.y===y) c="ğŸ‘§";
      if(GOAL.x===x&&GOAL.y===y) c="ğŸ°";
      if(revealed.includes(x+","+y)) c="ğŸ§›â€â™€ï¸";
      html+=`<div class="cell ${MAZE[y][x]?"wall":"path"}">${c}</div>`;
    }
  }

  html+=`</div>
    <div style="margin-top:12px">
      <button onclick="move(0,-1)">â–²</button><br/>
      <button onclick="move(-1,0)">â—€</button>
      <button onclick="move(1,0)">â–¶</button><br/>
      <button onclick="move(0,1)">â–¼</button>
    </div>
  </div>`;

  app.innerHTML=html;
}

function renderResult(){
  saveRanking();

  const list=getRanking()
    .slice(0,5)
    .map((r,i)=>`<div>${i+1}. ${r.name} Â· ${r.time}ì´ˆ</div>`)
    .join("");

  app.innerHTML=`
    <div class="screen">
      <div class="title">ì €íƒì— ë„ì°©í•˜ì…¨ìŠµë‹ˆë‹¤</div>
      <div class="desc">ì†Œìš” ì‹œê°„: ${elapsed}ì´ˆ</div>
      <div class="desc">í•¨ì • ë°Ÿì€ íšŸìˆ˜: ${trapCount}</div>

      <div class="desc" style="margin-top:16px">
        <strong>ğŸ† ë­í‚¹</strong><br/>${list}
      </div>

      <div class="desc" style="margin-top:20px">
        ë¬´ì‚¬íˆ ë±€íŒŒì´ì–´ì˜ ì €íƒì„ ë°©ë¬¸í•˜ê³  ë‚˜ì„œ<br/>
        ë²Œì–´ì§€ëŠ” ì¼ì´ ê¶ê¸ˆí•˜ë‹¤ë©´?<br/>
        <strong>ì—°ê·¹ &lt;ë±€íŒŒì´ì–´ë¥¼ ì´í•´í•˜ëŠ” íŠ¹ë³„í•œ ë°©ë²•&gt;</strong><br/>
        ë§ì€ ê´€ì‹¬ ë¶€íƒë“œë¦½ë‹ˆë‹¤.
      </div>

      <a href="https://tickets.interpark.com/goods/26000875"
         target="_blank"
         style="margin-top:22px">
        í‹°ì¼“ ì˜¤í”ˆ ì‚¬ì´íŠ¸ ë°”ë¡œê°€ê¸°
      </a>
    </div>
  `;
}

function saveRanking(){
  const data=getRanking();
  data.push({name:nickname,time:elapsed});
  data.sort((a,b)=>a.time-b.time);
  localStorage.setItem("vampireRank",JSON.stringify(data));
}

function getRanking(){
  return JSON.parse(localStorage.getItem("vampireRank")||"[]");
}

function move(dx,dy){
  let nx=pos.x+dx, ny=pos.y+dy;
  if(nx<0||ny<0||nx>=GRID||ny>=GRID) return;
  if(MAZE[ny][nx]) return;

  let trap=TRAPS.find(t=>t.x===nx&&t.y===ny);
  if(trap){
    revealed=[nx+","+ny];
    pos={x:nx,y:ny};
    trapCount++;
    renderMaze();
    setTimeout(()=>{
      pos={...START};
      revealed=[];
      renderMaze();
    },400);
    return;
  }

  pos={x:nx,y:ny};
  if(nx===GOAL.x&&ny===GOAL.y){
    elapsed=Math.floor((Date.now()-startTime)/1000);
    renderResult();
  } else renderMaze();
}

function startGame(){
  stage="maze";
  startTime=Date.now();
  renderMaze();
}

document.addEventListener("keydown",e=>{
  if(stage!=="maze")return;
  if(e.key==="ArrowUp")move(0,-1);
  if(e.key==="ArrowDown")move(0,1);
  if(e.key==="ArrowLeft")move(-1,0);
  if(e.key==="ArrowRight")move(1,0);
});

const timer=setInterval(()=>{
  if(i<narration.length){
    text+=narration[i++];
    renderIntro();
  } else clearInterval(timer);
},40);

renderIntro();
</script>
</body>
</html>




