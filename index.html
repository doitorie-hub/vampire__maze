<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>ë±€íŒŒì´ì–´ ì €íƒ ë¯¸ë¡œ</title>
<style>
  body {
    margin: 0;
    background: #000;
    color: #fff;
    font-family: serif;
    text-align: center;
  }
  button, a {
    background: #7a1f2b;
    color: #000;
    padding: 12px 24px;
    border-radius: 12px;
    text-decoration: none;
    border: none;
    font-size: 16px;
  }
  .maze {
    display: grid;
    gap: 2px;
    justify-content: center;
    margin-top: 12px;
  }
  .cell {
    width: 28px;
    height: 28px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 18px;
  }
  .wall { background: #2a0006; }
  .path { background: #111; }
</style>
</head>

<body>
<div id="app"></div>

<script>
const GRID = 11;
const CELL = 28;
const START = {x:0,y:10};
const GOAL = {x:10,y:0};

const MAZE = [
 [1,1,1,1,1,1,1,1,1,1,0],
 [1,0,0,0,1,0,0,0,0,1,0],
 [1,0,1,0,1,0,1,1,0,1,0],
 [1,0,0,0,0,0,0,0,0,0,0],
 [1,0,1,1,1,1,0,1,1,1,1],
 [1,0,0,0,0,0,0,0,0,0,1],
 [1,1,1,1,1,1,1,1,1,0,1],
 [1,0,0,0,0,0,0,0,1,0,1],
 [1,0,1,1,1,1,1,0,1,0,1],
 [1,0,0,0,0,0,0,0,0,0,1],
 [0,0,1,1,1,1,1,1,1,1,1],
];

const TRAPS = [
 {x:5,y:9},{x:7,y:3},{x:6,y:4},{x:3,y:1}
];

const narration =
"íƒœì´ˆì˜ ë±€íŒŒì´ì–´ë¥¼ ë°©ë¬¸í•˜ê²Œ ëœ ë‹¹ì‹ .\n" +
"í•˜ì§€ë§Œ ì €íƒì€ ìƒê°ë³´ë‹¤ ì™¸ì§„ ê³³ì— ìˆëŠ”ë°â€¦\n" +
"ê³¼ì—° ì‹œê°„ ë‚´ì— ê¸¸ì„ ì°¾ì•„ê°ˆ ìˆ˜ ìˆì„ê¹Œ?";

let stage="intro", text="", i=0;
let pos={...START}, startTime=0, elapsed=0, trapCount=0;
let revealed=[];

const app=document.getElementById("app");

function renderIntro(){
  app.innerHTML=`
    <p style="white-space:pre-line;max-width:360px;margin:auto">${text}</p>
    ${text.length===narration.length?`<button onclick="startGame()">ì €íƒìœ¼ë¡œ ê°€ê¸°</button>`:""}
  `;
}

function renderMaze(){
  let html=`<div class="maze" style="grid-template-columns:repeat(${GRID},${CELL}px)">`;
  for(let y=0;y<GRID;y++){
    for(let x=0;x<GRID;x++){
      let c="";
      if(pos.x===x&&pos.y===y) c="ğŸ‘§";
      if(GOAL.x===x&&GOAL.y===y) c="ğŸ°";
      if(revealed.includes(x+","+y)) c="ğŸ§›â€â™€ï¸";
      html+=`<div class="cell ${MAZE[y][x]?"wall":"path"}">${c}</div>`;
    }
  }
  html+=`</div>
  <div style="margin-top:12px">
    <button onclick="move(0,-1)">â–²</button><br/>
    <button onclick="move(-1,0)">â—€</button>
    <button onclick="move(1,0)">â–¶</button><br/>
    <button onclick="move(0,1)">â–¼</button>
  </div>`;
  app.innerHTML=html;
}

function renderResult(){
  app.innerHTML=`
    <h2>ì €íƒì— ë„ì°©í•˜ì…¨ìŠµë‹ˆë‹¤</h2>
    <p>ì†Œìš” ì‹œê°„: ${elapsed}ì´ˆ</p>
    <p>í•¨ì • ë°Ÿì€ íšŸìˆ˜: ${trapCount}</p>
    <p style="max-width:360px;margin:auto">
      ë¬´ì‚¬íˆ ë±€íŒŒì´ì–´ì˜ ì €íƒì„ ë°©ë¬¸í•˜ê³  ë‚˜ì„œ ë²Œì–´ì§€ëŠ” ì¼ì´ ê¶ê¸ˆí•˜ë‹¤ë©´?<br/>
      <strong>[ë±€íŒŒì´ì–´ë¥¼ ì´í•´í•˜ëŠ” íŠ¹ë³„í•œ ë°©ë²•]</strong><br/>
      ë§ì€ ê´€ì‹¬ ë¶€íƒë“œë¦½ë‹ˆë‹¤.
    </p>
    <a href="https://tickets.interpark.com/goods/26000875" target="_blank">í‹°ì¼“ ì˜¤í”ˆ ë°”ë¡œê°€ê¸°</a>
  `;
}

function move(dx,dy){
  let nx=pos.x+dx, ny=pos.y+dy;
  if(nx<0||ny<0||nx>=GRID||ny>=GRID) return;
  if(MAZE[ny][nx]) return;

  let trap=TRAPS.find(t=>t.x===nx&&t.y===ny);
  if(trap){
    revealed=[nx+","+ny];
    pos={x:nx,y:ny};
    trapCount++;
    renderMaze();
    setTimeout(()=>{pos={...START};revealed=[];renderMaze();},400);
    return;
  }

  pos={x:nx,y:ny};
  if(nx===GOAL.x&&ny===GOAL.y){
    elapsed=Math.floor((Date.now()-startTime)/1000);
    renderResult();
  } else renderMaze();
}

function startGame(){
  stage="maze";
  startTime=Date.now();
  renderMaze();
}

document.addEventListener("keydown",e=>{
  if(stage!=="maze")return;
  if(e.key==="ArrowUp")move(0,-1);
  if(e.key==="ArrowDown")move(0,1);
  if(e.key==="ArrowLeft")move(-1,0);
  if(e.key==="ArrowRight")move(1,0);
});

const timer=setInterval(()=>{
  if(i<narration.length){
    text+=narration[i++];
    renderIntro();
  } else clearInterval(timer);
},40);

renderIntro();
</script>
</body>
</html>
